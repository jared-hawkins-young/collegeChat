import{r as s,bI as pt,bC as t}from"./vendor-9f0443cf.js";import{R as ke,G as mt,V as _e,u as F,L as St,g as ht,U as bt,S as gt,Q as xt,E as Ct,A as kt,a as S,b as _t,c as yt,H as r,t as l,d as It,e as Tt,r as h,T as ft,f as vt,h as wt,i as Ft}from"./index-969d0285.js";import{b as n,c as jt,s as Rt,D as At,a as c,r as b}from"./fluentui-react-7118eba4.js";import"./fluentui-icons-153f2197.js";const Ot="_askContainer_1rw8c_1",Pt="_askTopSection_1rw8c_8",Vt="_askBottomSection_1rw8c_15",Ut="_askTitle_1rw8c_25",Nt="_askQuestionInput_1rw8c_31",Gt="_askAnswerContainer_1rw8c_37",Bt="_askAnalysisPanel_1rw8c_44",Lt="_askSettingsSeparator_1rw8c_49",Et="_settingsButton_1rw8c_55",Mt="_commandsContainer_1rw8c_61",Qt="_commandButton_1rw8c_68",o={askContainer:Ot,askTopSection:Pt,askBottomSection:Vt,askTitle:Ut,askQuestionInput:Nt,askAnswerContainer:Gt,askAnalysisPanel:Bt,askSettingsSeparator:Lt,settingsButton:Et,commandsContainer:Mt,commandButton:Qt};function Dt(){const[j,g]=s.useState(!1),[x,ye]=s.useState(""),[R,Ht]=s.useState(""),[A,qt]=s.useState(""),[O,Ie]=s.useState(.3),[C,Te]=s.useState(null),[P,fe]=s.useState(0),[V,ve]=s.useState(0),[U,N]=s.useState(ke.Hybrid),[G,we]=s.useState(3),[k,B]=s.useState(!0),[L,Fe]=s.useState(!1),[u,je]=s.useState(!1),[E,Re]=s.useState(mt.TextAndImages),[_,Ae]=s.useState(""),[Oe,Pe]=s.useState(""),[Ve,Ue]=s.useState([_e.Embedding,_e.ImageEmbedding]),[M,Ne]=s.useState(!1),[Q,Ge]=s.useState(!1),[D,Be]=s.useState(!1),[H,Le]=s.useState(!1),[Ee,Me]=s.useState(!1),[Qe,De]=s.useState(!1),[He,qe]=s.useState(!1),[ze,Je]=s.useState(!1),[q,Ke]=s.useState(!1),y=s.useRef(""),[I,z]=s.useState(!1),[p,J]=s.useState(),[i,We]=s.useState(),[Xe,K]=s.useState(null),[W,X]=s.useState(),[m,d]=s.useState(void 0),Y=F?pt().instance:void 0,{loggedIn:T}=s.useContext(St),Ye=async()=>{vt().then(e=>{Be(e.showGPT4VOptions),B(e.showSemanticRankerOption),Le(e.showSemanticRankerOption),Me(e.showVectorOption),e.showVectorOption||N(ke.Text),De(e.showUserUpload),qe(e.showSpeechInput),Je(e.showSpeechOutputBrowser),Ke(e.showSpeechOutputAzure)})};s.useEffect(()=>{Ye()},[]),s.useEffect(()=>{i&&q&&ht(i.message.content).then(e=>{K(e)})},[i]);const f=async e=>{y.current=e,p&&J(void 0),z(!0),X(void 0),d(void 0);const a=Y?await wt(Y):void 0;try{const w={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:x.length===0?void 0:x,prompt_template_prefix:R.length===0?void 0:R,prompt_template_suffix:A.length===0?void 0:A,exclude_category:_.length===0?void 0:_,top:G,temperature:O,minimum_reranker_score:P,minimum_search_score:V,retrieval_mode:U,semantic_ranker:k,semantic_captions:L,use_oid_security_filter:M,use_groups_security_filter:Q,vector_fields:Ve,use_gpt4v:u,gpt4v_input:E,...C!==null?{seed:C}:{}}},session_state:i?i.session_state:null},ut=await Ft(w,a);We(ut),K(null)}catch(w){J(w)}finally{z(!1)}},Ze=(e,a)=>{ye(a||"")},$e=(e,a)=>{Ie(parseFloat(a||"0"))},et=(e,a)=>{Te(parseInt(a||""))},tt=(e,a)=>{ve(parseFloat(a||"0"))},st=(e,a)=>{fe(parseFloat(a||"0"))},at=(e,a)=>{we(parseInt(a||"3"))},nt=(e,a)=>{B(!!a)},ot=(e,a)=>{Fe(!!a)},rt=(e,a)=>{Ae(a||"")},lt=e=>{f(e),Pe(e)},it=e=>{W===e&&m===S.CitationTab?d(void 0):(X(e),d(S.CitationTab))},v=e=>{d(m===e?void 0:e)},ct=(e,a)=>{Ne(!!a)},dt=(e,a)=>{Ge(!!a)},Z=n("promptTemplate"),$=n("promptTemplateField"),ee=n("temperature"),te=n("temperatureField"),se=n("seed"),ae=n("seedField"),ne=n("searchScore"),oe=n("searchScoreField"),re=n("rerankerScore"),le=n("rerankerScoreField"),ie=n("retrieveCount"),ce=n("retrieveCountField"),de=n("excludeCategory"),ue=n("excludeCategoryField"),pe=n("semanticRanker"),me=n("semanticRankerField"),Se=n("semanticCaptions"),he=n("semanticCaptionsField"),be=n("useOidSecurityFilter"),ge=n("useOidSecurityFilterField"),xe=n("useGroupsSecurityFilter"),Ce=n("useGroupsSecurityFilterField");return t.jsxs("div",{className:o.askContainer,children:[t.jsxs("div",{className:o.askTopSection,children:[t.jsxs("div",{className:o.commandsContainer,children:[Qe&&t.jsx(bt,{className:o.commandButton,disabled:T}),t.jsx(gt,{className:o.commandButton,onClick:()=>g(!j)})]}),t.jsx("h1",{className:o.askTitle,children:"Ask your data"}),t.jsx("div",{className:o.askQuestionInput,children:t.jsx(xt,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:I,initQuestion:Oe,onSend:e=>f(e),showSpeechInput:He})})]}),t.jsxs("div",{className:o.askBottomSection,children:[I&&t.jsx(jt,{label:"Generating answer"}),!y.current&&t.jsx(Ct,{onExampleClicked:lt,useGPT4V:u}),!I&&i&&!p&&t.jsx("div",{className:o.askAnswerContainer,children:t.jsx(kt,{answer:i,isStreaming:!1,onCitationClicked:e=>it(e),onThoughtProcessClicked:()=>v(S.ThoughtProcessTab),onSupportingContentClicked:()=>v(S.SupportingContentTab),showSpeechOutputAzure:q,showSpeechOutputBrowser:ze,speechUrl:Xe})}),p?t.jsx("div",{className:o.askAnswerContainer,children:t.jsx(_t,{error:p.toString(),onRetry:()=>f(y.current)})}):null,m&&i&&t.jsx(yt,{className:o.askAnalysisPanel,activeCitation:W,onActiveTabChanged:e=>v(e),citationHeight:"600px",answer:i,activeTab:m})]}),t.jsxs(Rt,{headerText:"Configure answer generation",isOpen:j,isBlocking:!1,onDismiss:()=>g(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(At,{onClick:()=>g(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(c,{id:$,className:o.chatSettingsSeparator,defaultValue:x,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:Ze,"aria-labelledby":Z,onRenderLabel:e=>t.jsx(r,{labelId:Z,fieldId:$,helpText:l.promptTemplate,label:e?.label})}),t.jsx(c,{id:te,className:o.chatSettingsSeparator,label:"Temperature",type:"number",min:0,max:1,step:.1,defaultValue:O.toString(),onChange:$e,"aria-labelledby":ee,onRenderLabel:e=>t.jsx(r,{labelId:ee,fieldId:te,helpText:l.temperature,label:e?.label})}),t.jsx(c,{id:ae,className:o.chatSettingsSeparator,label:"Seed",type:"text",defaultValue:C?.toString()||"",onChange:et,"aria-labelledby":se,onRenderLabel:e=>t.jsx(r,{labelId:se,fieldId:ae,helpText:l.seed,label:e?.label})}),t.jsx(c,{id:oe,className:o.chatSettingsSeparator,label:"Minimum search score",type:"number",min:0,step:.01,defaultValue:V.toString(),onChange:tt,"aria-labelledby":ne,onRenderLabel:e=>t.jsx(r,{labelId:ne,fieldId:oe,helpText:l.searchScore,label:e?.label})}),H&&t.jsx(c,{id:le,className:o.chatSettingsSeparator,label:"Minimum reranker score",type:"number",min:1,max:4,step:.1,defaultValue:P.toString(),onChange:st,"aria-labelledby":re,onRenderLabel:e=>t.jsx(r,{labelId:re,fieldId:le,helpText:l.rerankerScore,label:e?.label})}),t.jsx(c,{id:ce,className:o.chatSettingsSeparator,label:"Retrieve this many search results:",type:"number",min:1,max:50,defaultValue:G.toString(),onChange:at,"aria-labelledby":ie,onRenderLabel:e=>t.jsx(r,{labelId:ie,fieldId:ce,helpText:l.retrieveNumber,label:e?.label})}),t.jsx(c,{id:ue,className:o.chatSettingsSeparator,label:"Exclude category",defaultValue:_,onChange:rt,"aria-labelledby":de,onRenderLabel:e=>t.jsx(r,{labelId:de,fieldId:ue,helpText:l.excludeCategory,label:e?.label})}),H&&t.jsxs(t.Fragment,{children:[t.jsx(b,{id:me,className:o.chatSettingsSeparator,checked:k,label:"Use semantic ranker for retrieval",onChange:nt,"aria-labelledby":pe,onRenderLabel:e=>t.jsx(r,{labelId:pe,fieldId:me,helpText:l.useSemanticReranker,label:e?.label})}),t.jsx(b,{id:he,className:o.chatSettingsSeparator,checked:L,label:"Use semantic captions",onChange:ot,disabled:!k,"aria-labelledby":Se,onRenderLabel:e=>t.jsx(r,{labelId:Se,fieldId:he,helpText:l.useSemanticCaptions,label:e?.label})})]}),D&&t.jsx(It,{gpt4vInputs:E,isUseGPT4V:u,updateUseGPT4V:e=>{je(e)},updateGPT4VInputs:e=>Re(e)}),Ee&&t.jsx(Tt,{defaultRetrievalMode:U,showImageOptions:u&&D,updateVectorFields:e=>Ue(e),updateRetrievalMode:e=>N(e)}),F&&t.jsxs(t.Fragment,{children:[t.jsx(b,{id:ge,className:o.chatSettingsSeparator,checked:M||h,label:"Use oid security filter",disabled:!T||h,onChange:ct,"aria-labelledby":be,onRenderLabel:e=>t.jsx(r,{labelId:be,fieldId:ge,helpText:l.useOidSecurityFilter,label:e?.label})}),t.jsx(b,{id:Ce,className:o.chatSettingsSeparator,checked:Q||h,label:"Use groups security filter",disabled:!T||h,onChange:dt,"aria-labelledby":xe,onRenderLabel:e=>t.jsx(r,{labelId:xe,fieldId:Ce,helpText:l.useGroupsSecurityFilter,label:e?.label})})]}),F&&t.jsx(ft,{})]})]})}Dt.displayName="Ask";export{Dt as Component};
//# sourceMappingURL=Ask-f696b983.js.map

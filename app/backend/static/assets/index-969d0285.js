import{bB as Ts,bC as e,r as i,bD as Ut,bE as Is,bF as ks,bG as Ls,bH as Ns,bI as me,bJ as As,bK as Fs,bL as It,bM as Rs,bN as Ps,bO as Es,bP as Ms,bQ as Us,bR as Os,bS as Bs,bT as Vs,bU as qs,bV as kt}from"./vendor-9f0443cf.js";import{e as Gs,E as $s,M as Lt,f as Ds,g as Hs,D as Ot,h as zs,i as Qs}from"./fluentui-icons-153f2197.js";import{I as W,S as v,P as Ks,T as Ue,B as J,a as G,u as Ws,b as m,C as Bt,D as qe,c as Js,d as Xs,M as Ys,e as Zs,L as en,f as tn,g as Pe,h as Vt,i as ie,j as Oe,k as Nt,l as sn,m as nn,n as At,o as on,p as an,q as rn,r as Q,s as ln}from"./fluentui-react-7118eba4.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();const cn="_container_d0b9t_1",dn="_chatRoot_d0b9t_8",un="_chatContainer_d0b9t_13",hn="_chatEmptyState_d0b9t_21",pn="_chatEmptyStateTitle_d0b9t_31",mn="_chatEmptyStateSubtitle_d0b9t_38",gn="_chatMessageStream_d0b9t_43",xn="_chatMessageGpt_d0b9t_55",fn="_chatMessageGptMinWidth_d0b9t_61",bn="_chatInput_d0b9t_66",Sn="_chatAnalysisPanel_d0b9t_76",yn="_chatSettingsSeparator_d0b9t_84",_n="_loadingLogo_d0b9t_90",wn="_commandsContainer_d0b9t_94",vn="_commandButton_d0b9t_101",f={container:cn,chatRoot:dn,chatContainer:un,chatEmptyState:hn,chatEmptyStateTitle:pn,chatEmptyStateSubtitle:mn,chatMessageStream:gn,chatMessageGpt:xn,chatMessageGptMinWidth:fn,chatInput:bn,chatAnalysisPanel:Sn,chatSettingsSeparator:yn,loadingLogo:_n,commandsContainer:wn,commandButton:vn},jn=".auth/me",Cn=".auth/refresh",Tn=".auth/logout?post_logout_redirect_uri=/";async function In(){const t=await fetch("/auth_setup");if(!t.ok)throw new Error(`auth setup response was not ok: ${t.status}`);return await t.json()}const X=await In(),D=X.useLogin,de=X.requireAccessControl,kn=X.enableUnauthenticatedAccess,Ft=de&&!kn,Ln=X.msalConfig,Nn=X.loginRequest,An=X.tokenRequest,qt=()=>window.location.origin+X.msalConfig.auth.redirectUri;globalThis.cachedAppServicesToken=null;const ge=()=>{const t=n=>{const r=new Date;return new Date(n.expires_on)>r};if(globalThis.cachedAppServicesToken&&t(globalThis.cachedAppServicesToken))return Promise.resolve(globalThis.cachedAppServicesToken);const s=()=>fetch(jn).then(n=>n.ok?n.json().then(r=>r.length>0?{id_token:r[0].id_token,access_token:r[0].access_token,user_claims:r[0].user_claims.reduce((a,l)=>(a[l.typ]=l.val,a),{}),expires_on:r[0].expires_on}:null):null);return s().then(n=>n?t(n)?(globalThis.cachedAppServicesToken=n,n):fetch(Cn).then(r=>r.ok?s():null):null)},Fn=await ge()!=null,Rn=()=>{window.location.href=Tn},Be=async t=>!!(t&&t.getActiveAccount()||await ge()),ue=async t=>{const s=await ge();return s?Promise.resolve(s.access_token):t.acquireTokenSilent({...An,redirectUri:qt()}).then(n=>n.accessToken).catch(n=>{console.log(n)})},Ee=async t=>{const s=t.getActiveAccount();if(s)return s.username;const n=await ge();return n?.user_claims?n.user_claims.preferred_username:null},Pn=async t=>{const s=t.getActiveAccount();if(s)return s.idTokenClaims;const n=await ge();if(n)return n.user_claims},je="";async function ee(t){return D&&!Fn&&t?{Authorization:`Bearer ${t}`}:{}}async function En(){return await(await fetch(`${je}/config`,{method:"GET"})).json()}async function Oa(t,s){const n=await ee(s),r=await fetch(`${je}/ask`,{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await r.json();if(r.status>299||!r.ok)throw Error(a.error||"Unknown error");return a}async function Mn(t,s,n){let r=`${je}/chat`;s&&(r+="/stream");const a=await ee(n);return await fetch(r,{method:"POST",headers:{...a,"Content-Type":"application/json"},body:JSON.stringify(t)})}async function Un(t){return await fetch("/speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})}).then(s=>s.status==200?s.blob():s.status==400?(console.log("Speech synthesis is not enabled."),null):(console.error("Unable to get speech synthesis."),null)).then(s=>s?URL.createObjectURL(s):null)}function Gt(t){return`${je}/content/${t}`}async function On(t,s){const n=await fetch("/upload",{method:"POST",headers:await ee(s),body:t});if(!n.ok)throw new Error(`Uploading files failed: ${n.statusText}`);return await n.json()}async function Bn(t,s){const n=await ee(s),r=await fetch("/delete_uploaded",{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify({filename:t})});if(!r.ok)throw new Error(`Deleting file failed: ${r.statusText}`);return await r.json()}async function Vn(t){const s=await fetch("/list_uploaded",{method:"GET",headers:await ee(t)});if(!s.ok)throw new Error(`Listing files failed: ${s.statusText}`);return await s.json()}var N=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(N||{}),$=(t=>(t.TextAndImages="textAndImages",t.Images="images",t.Texts="texts",t))($||{}),M=(t=>(t.Embedding="embedding",t.ImageEmbedding="imageEmbedding",t.Both="both",t))(M||{});const qn="_answerContainer_1ynoh_1",Gn="_answerLogo_1ynoh_11",$n="_answerText_1ynoh_15",Dn="_selected_1ynoh_34",Hn="_citationLearnMore_1ynoh_38",zn="_citation_1ynoh_38",Qn="_followupQuestionsList_1ynoh_60",Kn="_followupQuestionLearnMore_1ynoh_64",Wn="_followupQuestion_1ynoh_60",Jn="_supContainer_1ynoh_83",Xn="_retryButton_1ynoh_112",Yn="_loadingdots_1ynoh_134",Zn="_loading_1ynoh_134",A={answerContainer:qn,answerLogo:Gn,answerText:$n,selected:Dn,citationLearnMore:Hn,citation:zn,followupQuestionsList:Qn,followupQuestionLearnMore:Kn,followupQuestion:Wn,supContainer:Jn,retryButton:Xn,loadingdots:Yn,loading:Zn};function eo(t,s,n){const r=[];let a=t.trim();if(s){let c=a.length;for(let p=a.length-1;p>=0&&a[p]!=="]";p--)if(a[p]==="["){c=p;break}a=a.substring(0,c)}return{answerHtml:a.split(/\[([^\]]+)\]/g).map((c,u)=>{if(u%2===0)return c;{let p;r.indexOf(c)!==-1?p=r.indexOf(c)+1:(r.push(c),p=r.length);const S=Gt(c);return Ts(e.jsx("a",{className:"supContainer",title:c,onClick:()=>n(S),children:e.jsx("sup",{children:p})}))}}).join(""),citations:r}}const $t=()=>e.jsx(Gs,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),to=window.speechSynthesis||window.webkitSpeechSynthesis;let K=null;try{K=to}catch{console.error("SpeechSynthesis is not supported")}const so=function(t){if(K){const s=new SpeechSynthesisUtterance(t);return s.lang="en-US",s.volume=1,s.rate=1,s.pitch=1,s.voice=K.getVoices().filter(n=>n.lang==="en-US")[0],s}},no=({answer:t})=>{const[s,n]=i.useState(!1),r=l=>{if(K!=null){if(s){K.cancel(),n(!1);return}const h=so(l);if(!h)return;K.speak(h),h.onstart=()=>{n(!0)},h.onend=()=>{n(!1)}}},a=s?"red":"black";return e.jsx(W,{style:{color:a},iconProps:{iconName:"Volume3"},title:"Speak answer",ariaLabel:"Speak answer",onClick:()=>r(t),disabled:!K})};let we=new Audio;const oo=({url:t})=>{const[s,n]=i.useState(!1),r=async()=>{if(s){we.pause(),n(!1);return}if(!t){console.error("Speech output is not yet available.");return}we=new Audio(t),await we.play(),we.addEventListener("ended",()=>{n(!1)}),n(!0)},a=s?"red":"black";return e.jsx(W,{style:{color:a},iconProps:{iconName:"Volume3"},title:"Speak answer",ariaLabel:"Speak answer",onClick:()=>r(),disabled:!t})},Rt=({answer:t,isSelected:s,isStreaming:n,onCitationClicked:r,onThoughtProcessClicked:a,onSupportingContentClicked:l,onFollowupQuestionClicked:h,showFollowupQuestions:c,showSpeechOutputAzure:u,showSpeechOutputBrowser:p,speechUrl:S})=>{const y=t.context?.followup_questions,_=t.message.content,w=i.useMemo(()=>eo(_,n,r),[t]),g=Ut.sanitize(w.answerHtml);return e.jsxs(v,{className:`${A.answerContainer} ${s&&A.selected}`,verticalAlign:"space-between",children:[e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx($t,{}),e.jsxs("div",{children:[e.jsx(W,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>a(),disabled:!t.context.thoughts?.length}),e.jsx(W,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>l(),disabled:!t.context.data_points}),u&&e.jsx(oo,{url:S}),p&&e.jsx(no,{answer:g})]})]})}),e.jsx(v.Item,{grow:!0,children:e.jsx("div",{className:A.answerText,dangerouslySetInnerHTML:{__html:g}})}),!!w.citations.length&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:A.citationLearnMore,children:"Citations:"}),w.citations.map((x,j)=>{const q=Gt(x);return e.jsx("a",{className:A.citation,title:x,onClick:()=>r(q),children:`${++j}. ${x}`},j)})]})}),!!y?.length&&c&&h&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,className:`${w.citations.length?A.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:A.followupQuestionLearnMore,children:"Follow-up questions:"}),y.map((x,j)=>e.jsx("a",{className:A.followupQuestion,title:x,onClick:()=>h(x),children:`${x}`},j))]})})]})},ao=()=>{const t=Is({from:{opacity:0},to:{opacity:1}});return e.jsx(ks.div,{style:{...t},children:e.jsxs(v,{className:A.answerContainer,verticalAlign:"space-between",children:[e.jsx($t,{}),e.jsx(v.Item,{grow:!0,children:e.jsxs("p",{className:A.answerText,children:["Generating answer",e.jsx("span",{className:A.loadingdots})]})})]})})},ro=({error:t,onRetry:s})=>e.jsxs(v,{className:A.answerContainer,verticalAlign:"space-between",children:[e.jsx($s,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(v.Item,{grow:!0,children:e.jsx("p",{className:A.answerText,children:t})}),e.jsx(Ks,{className:A.retryButton,onClick:s,text:"Retry"})]}),io="_questionInputContainer_n0fev_1",lo="_questionInputTextArea_n0fev_11",co="_questionInputButtonsContainer_n0fev_16",he={questionInputContainer:io,questionInputTextArea:lo,questionInputButtonsContainer:co},uo=window.speechRecognition||window.webkitSpeechRecognition;let L=null;try{L=new uo,L!=null&&(L.lang="en-US",L.interimResults=!0)}catch{console.error("SpeechRecognition not supported"),L=null}const ho=({updateQuestion:t})=>{const[s,n]=i.useState(!1),r=()=>{if(L==null){console.error("SpeechRecognition not supported");return}L.onresult=l=>{let h="";for(const c of l.results)h+=c[0].transcript;t(h)},L.onend=()=>{n(!1)},L.onerror=l=>{L&&(L.stop(),l.error=="no-speech"?alert("No speech was detected. Please check your system audio settings and try again."):l.error=="language-not-supported"?alert(`Speech recognition error detected: ${l.error}. The speech recognition input functionality does not yet work on all browsers, like Edge in Mac OS X with ARM chips. Try another browser/OS.`):alert(`Speech recognition error detected: ${l.error}.`))},n(!0),L.start()},a=()=>{if(L==null){console.error("SpeechRecognition not supported");return}L.stop(),n(!1)};return L==null?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[!s&&e.jsx("div",{className:he.questionInputButtonsContainer,children:e.jsx(Ue,{content:"Ask question with voice",relationship:"label",children:e.jsx(J,{size:"large",icon:e.jsx(Lt,{primaryFill:"rgba(115, 118, 225, 1)"}),onClick:r})})}),s&&e.jsx("div",{className:he.questionInputButtonsContainer,children:e.jsx(Ue,{content:"Stop recording question",relationship:"label",children:e.jsx(J,{size:"large",icon:e.jsx(Lt,{primaryFill:"rgba(250, 0, 0, 0.7)"}),disabled:!s,onClick:a})})})]})},pe=i.createContext({loggedIn:!1,setLoggedIn:t=>{}}),po=({onSend:t,disabled:s,placeholder:n,clearOnSend:r,initQuestion:a,showSpeechInput:l})=>{const[h,c]=i.useState(""),{loggedIn:u}=i.useContext(pe);i.useEffect(()=>{a&&c(a)},[a]);const p=()=>{s||!h.trim()||(t(h),r&&c(""))},S=g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),p())},y=(g,x)=>{x?x.length<=1e3&&c(x):c("")},_=Ft&&!u,w=s||!h.trim()||Ft;return _&&(n="Please login to continue..."),e.jsxs(v,{horizontal:!0,className:he.questionInputContainer,children:[e.jsx(G,{className:he.questionInputTextArea,disabled:_,placeholder:n,multiline:!0,resizable:!1,borderless:!0,value:h,onChange:y,onKeyDown:S}),e.jsx("div",{className:he.questionInputButtonsContainer,children:e.jsx(Ue,{content:"Submit question",relationship:"label",children:e.jsx(J,{size:"large",icon:e.jsx(Ds,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:w,onClick:p})})}),l&&e.jsx(ho,{updateQuestion:c})]})},mo="_examplesNavList_1uwvb_1",go="_example_1uwvb_1",xo="_exampleText_1uwvb_29",Ve={examplesNavList:mo,example:go,exampleText:xo},fo=({text:t,value:s,onClick:n})=>e.jsx("div",{className:Ve.example,onClick:()=>n(s),children:e.jsx("p",{className:Ve.exampleText,children:t})}),bo=["What is included in my Northwind Health Plus plan that is not in standard?","What happens in a performance review?","What does a Product Manager do?"],So=["Compare the impact of interest rates and GDP in financial markets.","What is the expected trend for the S&P 500 index over the next five years? Compare it to the past S&P 500 performance","Can you identify any correlation between oil prices and stock market trends?"],yo=({onExampleClicked:t,useGPT4V:s})=>e.jsx("ul",{className:Ve.examplesNavList,children:(s?So:bo).map((n,r)=>e.jsx("li",{children:e.jsx(fo,{text:n,value:n,onClick:t})},r))}),_o="_container_6dn84_1",wo="_message_6dn84_9",Pt={container:_o,message:wo},ve=({message:t})=>e.jsx("div",{className:Pt.container,children:e.jsx("div",{className:Pt.message,children:t})}),Et={childrenGap:4,maxWidth:300},vo={root:{padding:20}},jo={root:{marginBottom:-3}},Co={iconName:"Info"},C=t=>{const[s,{toggle:n}]=Ws(!1),r=m("description"),a=m("iconButton");return e.jsxs(e.Fragment,{children:[e.jsxs(v,{horizontal:!0,verticalAlign:"center",tokens:Et,children:[e.jsx("label",{id:t.labelId,htmlFor:t.fieldId,children:t.label}),e.jsx(W,{id:a,iconProps:Co,title:"Info",ariaLabel:"Info",onClick:n,styles:jo})]}),s&&e.jsx(Bt,{target:"#"+a,setInitialFocus:!0,onDismiss:n,ariaDescribedBy:r,role:"alertdialog",children:e.jsxs(v,{tokens:Et,horizontalAlign:"start",styles:vo,children:[e.jsx("span",{id:r,children:t.helpText}),e.jsx(qe,{onClick:n,children:"Close"})]})})]})},To="_thoughtProcess_oxg2f_1",Io="_tList_oxg2f_8",ko="_tListItem_oxg2f_14",Lo="_tStep_oxg2f_40",No="_tCodeBlock_oxg2f_47",Ao="_tProp_oxg2f_51",Fo="_citationImg_oxg2f_60",Z={thoughtProcess:To,tList:Io,tListItem:ko,tStep:Lo,tCodeBlock:No,tProp:Ao,citationImg:Fo};function Ro(t){const s=t.split(": "),n=s[0],r=Ut.sanitize(s.slice(1).join(": "));return{title:n,content:r}}const Po="_supportingContentNavList_1o6aa_1",Eo="_supportingContentItem_1o6aa_9",Mo="_supportingContentItemHeader_1o6aa_22",Uo="_supportingContentItemText_1o6aa_26",Oo="_supportingContentItemImage_1o6aa_31",le={supportingContentNavList:Po,supportingContentItem:Eo,supportingContentItemHeader:Mo,supportingContentItemText:Uo,supportingContentItemImage:Oo},Bo=({supportingContent:t})=>{const s=Array.isArray(t)?t:t.text,n=Array.isArray(t)?[]:t?.images;return e.jsxs("ul",{className:le.supportingContentNavList,children:[s.map((r,a)=>{const l=Ro(r);return e.jsxs("li",{className:le.supportingContentItem,children:[e.jsx("h4",{className:le.supportingContentItemHeader,children:l.title}),e.jsx("p",{className:le.supportingContentItemText,dangerouslySetInnerHTML:{__html:l.content}})]},a)}),n?.map((r,a)=>e.jsx("img",{className:le.supportingContentItemImage,src:r.url},a))]})};var B=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(B||{});const Vo=({thoughts:t})=>e.jsx("ul",{className:Z.tList,children:t.map((s,n)=>e.jsxs("li",{className:Z.tListItem,children:[e.jsx("div",{className:Z.tStep,children:s.title}),e.jsx(v,{horizontal:!0,tokens:{childrenGap:5},children:s.props&&(Object.keys(s.props)||[]).map(r=>e.jsxs("span",{className:Z.tProp,children:[r,": ",JSON.stringify(s.props?.[r])]}))}),Array.isArray(s.description)?e.jsx(Ls,{language:"json",wrapLongLines:!0,className:Z.tCodeBlock,children:JSON.stringify(s.description,null,2)}):e.jsx("div",{children:s.description})]},n))}),qo="_downloadButton_2t7ea_1",Go="_markdownViewer_2t7ea_6",$o="_loading_2t7ea_15",Do="_error_2t7ea_21",Ho="_markdown_2t7ea_6",z={downloadButton:qo,markdownViewer:Go,loading:$o,error:Do,markdown:Ho},zo=({src:t})=>{const[s,n]=i.useState(""),[r,a]=i.useState(!0),[l,h]=i.useState(null),c=u=>{const p=/<a\s+(?:[^>]*?\s+)?href=['"](#[^"']*?)['"][^>]*?>/g;return u.replace(p,"")};return i.useEffect(()=>{(async()=>{try{const p=await fetch(t);if(!p.ok)throw new Error("Failed loading markdown file.");const S=await p.text(),y=await Ns.parse(S),_=c(y);n(_)}catch(p){h(p)}finally{a(!1)}})()},[t]),e.jsx("div",{children:r?e.jsx("div",{className:`${z.loading} ${z.markdownViewer}`,children:e.jsx(Js,{size:Xs.large,label:"Loading file"})}):l?e.jsx("div",{className:`${z.error} ${z.markdownViewer}`,children:e.jsxs(Ys,{messageBarType:Zs.error,isMultiline:!1,children:[l.message,e.jsx(en,{href:t,download:!0,children:"Download the file"})]})}):e.jsxs("div",{children:[e.jsx(W,{className:z.downloadButton,style:{color:"black"},iconProps:{iconName:"Save"},title:"Save",ariaLabel:"Save",href:t,download:!0}),e.jsx("div",{className:`${z.markdown} ${z.markdownViewer}`,dangerouslySetInnerHTML:{__html:s}})]})})},Me={disabled:!0,style:{color:"grey"}},Qo=({answer:t,activeTab:s,activeCitation:n,citationHeight:r,className:a,onActiveTabChanged:l})=>{const h=!t.context.thoughts,c=!t.context.data_points,u=!n,[p,S]=i.useState(""),y=D?me().instance:void 0,_=async()=>{const g=y?await ue(y):void 0;if(n){const x=n.indexOf("#")?n.split("#")[1]:"",q=await(await fetch(n,{method:"GET",headers:await ee(g)})).blob();let U=URL.createObjectURL(q);x&&(U+="#"+x),S(U)}};i.useEffect(()=>{_()},[]);const w=()=>{if(!n)return null;switch(n.split(".").pop()?.toLowerCase()){case"png":return e.jsx("img",{src:p,className:Z.citationImg,alt:"Citation Image"});case"md":return e.jsx(zo,{src:n});default:return e.jsx("iframe",{title:"Citation",src:p,width:"100%",height:r})}};return e.jsxs(tn,{className:a,selectedKey:s,onLinkClick:g=>g&&l(g.props.itemKey),children:[e.jsx(Pe,{itemKey:B.ThoughtProcessTab,headerText:"Thought process",headerButtonProps:h?Me:void 0,children:e.jsx(Vo,{thoughts:t.context.thoughts||[]})}),e.jsx(Pe,{itemKey:B.SupportingContentTab,headerText:"Supporting content",headerButtonProps:c?Me:void 0,children:e.jsx(Bo,{supportingContent:t.context.data_points})}),e.jsx(Pe,{itemKey:B.CitationTab,headerText:"Citation",headerButtonProps:u?Me:void 0,children:w()})]})},Ko="_container_286vi_1",Wo={container:Ko},Jo=({className:t,onClick:s})=>e.jsx("div",{className:`${Wo.container} ${t??""}`,children:e.jsx(J,{icon:e.jsx(Hs,{}),onClick:s,children:"Developer settings"})}),Xo="_container_286vi_1",Yo={container:Xo},Zo=({className:t,disabled:s,onClick:n})=>e.jsx("div",{className:`${Yo.container} ${t??""}`,children:e.jsx(J,{icon:e.jsx(Ot,{}),disabled:s,onClick:n,children:"Clear chat"})}),ea="_container_11shd_1",ta="_callout_11shd_9",sa="_list_11shd_14",na="_item_11shd_20",ce={container:ea,callout:ta,list:sa,item:na},oa=({className:t,disabled:s})=>{const[n,r]=i.useState(!1),[a,l]=i.useState(!1),[h,c]=i.useState(!0),[u,p]=i.useState({}),[S,y]=i.useState(),[_,w]=i.useState(),[g,x]=i.useState([]);if(!D)throw new Error("The UploadFile component requires useLogin to be true");const j=me().instance,q=async()=>{r(!n);try{const b=await ue(j);if(!b)throw new Error("No authentication token available");U(b)}catch(b){console.error(b),c(!1)}},U=async b=>{Vn(b).then(k=>{c(!1),p({}),x(k)})},Ce=async b=>{p({...u,[b]:"pending"});try{const k=await ue(j);if(!k)throw new Error("No authentication token available");await Bn(b,k),p({...u,[b]:"success"}),U(k)}catch(k){p({...u,[b]:"error"}),console.error(k)}},xe=async b=>{if(b.preventDefault(),!b.target.files||b.target.files.length===0)return;l(!0);const k=b.target.files[0],fe=new FormData;fe.append("file",k);try{const O=await ue(j);if(!O)throw new Error("No authentication token available");const Te=await On(fe,O);y(Te),l(!1),w(void 0),U(O)}catch(O){console.error(O),l(!1),w("Error uploading file - please try again or contact admin.")}};return e.jsx("div",{className:`${ce.container} ${t??""}`,children:e.jsxs("div",{children:[e.jsx(J,{id:"calloutButton",icon:e.jsx(zs,{}),disabled:s,onClick:q,children:"Manage file uploads"}),n&&e.jsxs(Bt,{role:"dialog",gapSpace:0,className:ce.callout,target:"#calloutButton",onDismiss:()=>r(!1),setInitialFocus:!0,children:[e.jsx("form",{encType:"multipart/form-data",children:e.jsxs("div",{children:[e.jsx(Vt,{children:"Upload file:"}),e.jsx("input",{accept:".txt, .md, .json, .png, .jpg, .jpeg, .bmp, .heic, .tiff, .pdf, .docx, .xlsx, .pptx, .html",className:ce.chooseFiles,type:"file",onChange:xe})]})}),a&&e.jsx(ie,{children:"Uploading files..."}),!a&&_&&e.jsx(ie,{children:_}),!a&&S&&e.jsx(ie,{children:S.message}),e.jsx("h3",{children:"Previously uploaded files:"}),h&&e.jsx(ie,{children:"Loading..."}),!h&&g.length===0&&e.jsx(ie,{children:"No files uploaded yet"}),g.map((b,k)=>e.jsxs("div",{className:ce.list,children:[e.jsx("div",{className:ce.item,children:b}),e.jsxs(J,{icon:e.jsx(Ot,{}),onClick:()=>Ce(b),disabled:u[b]==="pending"||u[b]==="success",children:[!u[b]&&"Delete file",u[b]=="pending"&&"Deleting file...",u[b]=="error"&&"Error deleting.",u[b]=="success"&&"File deleted"]})]},k))]})]})})},aa="_container_1y0oo_1",ra={container:aa},T={promptTemplate:"Overrides the prompt used to generate the answer based on the question and search results. To append to existing prompt instead of replace whole prompt, start your prompt with '>>>'.",temperature:"Sets the temperature of the request to the LLM that generates the answer. Higher temperatures result in more creative responses, but they may be less grounded.",seed:"Sets a seed to improve the reproducibility of the model's responses. The seed can be any integer.",searchScore:"Sets a minimum score for search results coming back from Azure AI search. The score range depends on whether you're using hybrid (default), vectors only, or text only.",rerankerScore:"Sets a minimum score for search results coming back from the semantic reranker. The score always ranges between 0-4. The higher the score, the more semantically relevant the result is to the question.",retrieveNumber:"Sets the number of search results to retrieve from Azure AI search. More results may increase the likelihood of finding the correct answer, but may lead to the model getting 'lost in the middle'.",excludeCategory:"Specifies a category to exclude from the search results. There are no categories used in the default data set.",useSemanticReranker:"Enables the Azure AI Search semantic ranker, a model that re-ranks search results based on semantic similarity to the user's query.",useSemanticCaptions:"Sends semantic captions to the LLM instead of the full search result. A semantic caption is extracted from a search result during the process of semantic ranking.",suggestFollowupQuestions:"Asks the LLM to suggest follow-up questions based on the user's query.",useGPT4Vision:"Uses GPT-4-Turbo with Vision to generate responses based on images and text from the index.",vectorFields:"Specifies which embedding fields in the Azure AI Search Index will be searched, both the 'Images and text' embeddings, 'Images' only, or 'Text' only.",gpt4VisionInputs:"Sets what will be sent to the vision model. 'Images and text' sends both images and text to the model, 'Images' sends only images, and 'Text' sends only text.",retrievalMode:"Sets the retrieval mode for the Azure AI Search query. `Vectors + Text (Hybrid)` uses a combination of vector search and full text search, `Vectors` uses only vector search, and `Text` uses only full text search. Hybrid is generally optimal.",streamChat:"Continuously streams the response to the chat UI as it is generated.",useOidSecurityFilter:"Filter search results based on the authenticated user's OID.",useGroupsSecurityFilter:"Filter search results based on the authenticated user's groups."},ia=({updateRetrievalMode:t,updateVectorFields:s,showImageOptions:n,defaultRetrievalMode:r})=>{const[a,l]=i.useState(N.Hybrid),[h,c]=i.useState(M.Both),u=(g,x)=>{l(x?.data||N.Hybrid),t(x?.data||N.Hybrid)},p=(g,x)=>{c(x?.key),s([x?.key])};i.useEffect(()=>{s(n?[M.Embedding,M.ImageEmbedding]:[M.Embedding])},[n]);const S=m("retrievalMode"),y=m("retrievalModeField"),_=m("vectorFields"),w=m("vectorFieldsField");return e.jsxs(v,{className:ra.container,tokens:{childrenGap:10},children:[e.jsx(Oe,{id:y,label:"Retrieval mode",selectedKey:r.toString(),options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:a==N.Hybrid,data:N.Hybrid},{key:"vectors",text:"Vectors",selected:a==N.Vectors,data:N.Vectors},{key:"text",text:"Text",selected:a==N.Text,data:N.Text}],required:!0,onChange:u,"aria-labelledby":S,onRenderLabel:g=>e.jsx(C,{labelId:S,fieldId:y,helpText:T.retrievalMode,label:g?.label})}),n&&[N.Vectors,N.Hybrid].includes(a)&&e.jsx(Oe,{id:w,label:"Vector fields (Multi-query vector search)",options:[{key:M.Embedding,text:"Text Embeddings",selected:h===M.Embedding},{key:M.ImageEmbedding,text:"Image Embeddings",selected:h===M.ImageEmbedding},{key:M.Both,text:"Text and Image embeddings",selected:h===M.Both}],onChange:p,"aria-labelledby":_,onRenderLabel:g=>e.jsx(C,{labelId:_,fieldId:w,helpText:T.vectorFields,label:g?.label})})]})},la=()=>{const{instance:t}=me();t.getActiveAccount();const[s,n]=i.useState(void 0);i.useEffect(()=>{(async()=>{n(await Pn(t))})()},[]);const r=c=>typeof c=="string"?c:JSON.stringify(c),l=(c=>Object.keys(c??{}).map(u=>{let p=u;try{const y=new URL(u).pathname.split("/");u=y[y.length-1]}catch{}return{name:u,value:r((c??{})[p])}}))(s),h=[Nt({columnId:"name",compare:(c,u)=>c.name.localeCompare(u.name),renderHeaderCell:()=>"Name",renderCell:c=>c.name}),Nt({columnId:"value",compare:(c,u)=>c.value.localeCompare(u.value),renderHeaderCell:()=>"Value",renderCell:c=>c.value})];return e.jsxs("div",{children:[e.jsx(Vt,{children:"ID Token Claims"}),e.jsxs(sn,{items:l,columns:h,sortable:!0,getRowId:c=>c.name,children:[e.jsx(nn,{children:e.jsx(At,{children:({renderHeaderCell:c})=>e.jsx(on,{children:c()})})}),e.jsx(an,{children:({item:c,rowId:u})=>e.jsx(At,{children:({renderCell:p})=>e.jsx(rn,{children:p(c)})},u)})]})]})},ca="_container_1y0oo_1",da={container:ca},ua=({updateGPT4VInputs:t,updateUseGPT4V:s,isUseGPT4V:n,gpt4vInputs:r})=>{const[a,l]=i.useState(n),[h,c]=i.useState(r||$.TextAndImages),u=(g,x)=>{s(!!x),l(!!x)},p=(g,x)=>{if(x){const j=x.key;t(j||$.TextAndImages),j&&c(j)}};i.useEffect(()=>{a&&t($.TextAndImages)},[a]);const S=m("useGPT4V"),y=m("useGPT4VField"),_=m("gpt4VInput"),w=m("gpt4VInputField");return e.jsxs(v,{className:da.container,tokens:{childrenGap:10},children:[e.jsx(Q,{id:y,checked:a,label:"Use GPT vision model",onChange:u,"aria-labelledby":S,onRenderLabel:g=>e.jsx(C,{labelId:S,fieldId:y,helpText:T.useGPT4Vision,label:g?.label})}),a&&e.jsx(Oe,{id:w,selectedKey:h,label:"GPT vision model inputs",options:[{key:$.TextAndImages,text:"Images and text"},{text:"Images",key:$.Images},{text:"Text",key:$.Texts}],required:!0,onChange:p,"aria-labelledby":_,onRenderLabel:g=>e.jsx(C,{labelId:_,fieldId:w,helpText:T.gpt4VisionInputs,label:g?.label})})]})},ha=()=>{const[t,s]=i.useState(!1),[n,r]=i.useState(""),[a,l]=i.useState(.3),[h,c]=i.useState(null),[u,p]=i.useState(0),[S,y]=i.useState(0),[_,w]=i.useState(3),[g,x]=i.useState(N.Hybrid),[j,q]=i.useState(!0),[U,Ce]=i.useState(!0),[xe,b]=i.useState(!1),[k,fe]=i.useState(""),[O,Te]=i.useState(!1),[Dt,Ht]=i.useState([M.Embedding]),[Ge,zt]=i.useState(!1),[$e,Qt]=i.useState(!1),[De,Kt]=i.useState($.TextAndImages),[be,Wt]=i.useState(!1),H=i.useRef(""),Ie=i.useRef(null),[Se,ye]=i.useState(!1),[He,ke]=i.useState(!1),[_e,Le]=i.useState(),[ze,Ne]=i.useState(),[te,Y]=i.useState(void 0),[se,Qe]=i.useState(0),[I,Ae]=i.useState([]),[Ke,We]=i.useState([]),[ne,Jt]=i.useState([]),[Je,Xt]=i.useState(!1),[Xe,Yt]=i.useState(!1),[Zt,es]=i.useState(!1),[ts,ss]=i.useState(!1),[ns,os]=i.useState(!1),[Ye,as]=i.useState(!1),[Fe,rs]=i.useState(!1),is=async()=>{En().then(o=>{Xt(o.showGPT4VOptions),q(o.showSemanticRankerOption),Yt(o.showSemanticRankerOption),es(o.showVectorOption),o.showVectorOption||x(N.Text),ss(o.showUserUpload),os(o.showSpeechInput),as(o.showSpeechOutputBrowser),rs(o.showSpeechOutputAzure)})},ls=async(o,d,E)=>{let re="",F={};const V=R=>new Promise(js=>{setTimeout(()=>{re+=R;const Cs={...F,message:{content:re,role:F.message.role}};We([...d,[o,Cs]]),js(null)},33)});try{ke(!0);for await(const R of As(E))if(R.context&&R.context.data_points)R.message=R.delta,F=R;else if(R.delta.content)ye(!1),await V(R.delta.content);else if(R.context)F.context={...F.context,...R.context};else if(R.error)throw Error(R.error)}finally{ke(!1)}return{...F,message:{content:re,role:F.message.role}}},Ze=D?me().instance:void 0,{loggedIn:Re}=i.useContext(pe),oe=async o=>{H.current=o,_e&&Le(void 0),ye(!0),Ne(void 0),Y(void 0);const d=Ze?await ue(Ze):void 0;try{const re={messages:[...I.flatMap(V=>[{content:V[0],role:"user"},{content:V[1].message.content,role:"assistant"}]),{content:o,role:"user"}],context:{overrides:{prompt_template:n.length===0?void 0:n,exclude_category:k.length===0?void 0:k,top:_,temperature:a,minimum_reranker_score:u,minimum_search_score:S,retrieval_mode:g,semantic_ranker:j,semantic_captions:xe,suggest_followup_questions:O,use_oid_security_filter:Ge,use_groups_security_filter:$e,vector_fields:Dt,use_gpt4v:be,gpt4v_input:De,...h!==null?{seed:h}:{}}},session_state:I.length?I[I.length-1][1].session_state:null},F=await Mn(re,U,d);if(!F.body)throw Error("No response body");if(U){const V=await ls(o,I,F.body);Ae([...I,[o,V]])}else{const V=await F.json();if(F.status>299||!F.ok)throw Error(V.error||"Unknown error");Ae([...I,[o,V]])}}catch(E){Le(E)}finally{ye(!1)}},cs=()=>{H.current="",_e&&Le(void 0),Ne(void 0),Y(void 0),Ae([]),We([]),ye(!1),ke(!1)};i.useEffect(()=>Ie.current?.scrollIntoView({behavior:"smooth"}),[Se]),i.useEffect(()=>Ie.current?.scrollIntoView({behavior:"auto"}),[Ke]),i.useEffect(()=>{is()},[]),i.useEffect(()=>{if(I&&Fe)for(let o=0;o<I.length;o++)ne[o]||Un(I[o][1].message.content).then(d=>{Jt([...ne.slice(0,o),d,...ne.slice(o+1)])})},[I]);const ds=(o,d)=>{r(d||"")},us=(o,d)=>{l(parseFloat(d||"0"))},hs=(o,d)=>{c(parseInt(d||""))},ps=(o,d)=>{y(parseFloat(d||"0"))},ms=(o,d)=>{p(parseFloat(d||"0"))},gs=(o,d)=>{w(parseInt(d||"3"))},xs=(o,d)=>{q(!!d)},fs=(o,d)=>{b(!!d)},bs=(o,d)=>{Ce(!!d)},Ss=(o,d)=>{fe(d||"")},ys=(o,d)=>{Te(!!d)},_s=(o,d)=>{zt(!!d)},ws=(o,d)=>{Qt(!!d)},vs=o=>{oe(o)},et=(o,d)=>{ze===o&&te===B.CitationTab&&se===d?Y(void 0):(Ne(o),Y(B.CitationTab)),Qe(d)},ae=(o,d)=>{Y(te===o&&se===d?void 0:o),Qe(d)},tt=m("promptTemplate"),st=m("promptTemplateField"),nt=m("temperature"),ot=m("temperatureField"),at=m("seed"),rt=m("seedField"),it=m("searchScore"),lt=m("searchScoreField"),ct=m("rerankerScore"),dt=m("rerankerScoreField"),ut=m("retrieveCount"),ht=m("retrieveCountField"),pt=m("excludeCategory"),mt=m("excludeCategoryField"),gt=m("semanticRanker"),xt=m("semanticRankerField"),ft=m("semanticCaptions"),bt=m("semanticCaptionsField"),St=m("suggestFollowupQuestions"),yt=m("suggestFollowupQuestionsField"),_t=m("useOidSecurityFilter"),wt=m("useOidSecurityFilterField"),vt=m("useGroupsSecurityFilter"),jt=m("useGroupsSecurityFilterField"),Ct=m("shouldStream"),Tt=m("shouldStreamField");return e.jsxs("div",{className:f.container,children:[e.jsxs("div",{className:f.commandsContainer,children:[e.jsx(Zo,{className:f.commandButton,onClick:cs,disabled:!H.current||Se}),ts&&e.jsx(oa,{className:f.commandButton,disabled:!Re}),e.jsx(Jo,{className:f.commandButton,onClick:()=>s(!t)})]}),e.jsxs("div",{className:f.chatRoot,children:[e.jsxs("div",{className:f.chatContainer,children:[H.current?e.jsxs("div",{className:f.chatMessageStream,children:[He&&Ke.map((o,d)=>e.jsxs("div",{children:[e.jsx(ve,{message:o[0]}),e.jsx("div",{className:f.chatMessageGpt,children:e.jsx(Rt,{isStreaming:!0,answer:o[1],isSelected:!1,onCitationClicked:E=>et(E,d),onThoughtProcessClicked:()=>ae(B.ThoughtProcessTab,d),onSupportingContentClicked:()=>ae(B.SupportingContentTab,d),onFollowupQuestionClicked:E=>oe(E),showFollowupQuestions:O&&I.length-1===d,showSpeechOutputAzure:Fe,showSpeechOutputBrowser:Ye,speechUrl:ne[d]},d)})]},d)),!He&&I.map((o,d)=>e.jsxs("div",{children:[e.jsx(ve,{message:o[0]}),e.jsx("div",{className:f.chatMessageGpt,children:e.jsx(Rt,{isStreaming:!1,answer:o[1],isSelected:se===d&&te!==void 0,onCitationClicked:E=>et(E,d),onThoughtProcessClicked:()=>ae(B.ThoughtProcessTab,d),onSupportingContentClicked:()=>ae(B.SupportingContentTab,d),onFollowupQuestionClicked:E=>oe(E),showFollowupQuestions:O&&I.length-1===d,showSpeechOutputAzure:Fe,showSpeechOutputBrowser:Ye,speechUrl:ne[d]},d)})]},d)),Se&&e.jsxs(e.Fragment,{children:[e.jsx(ve,{message:H.current}),e.jsx("div",{className:f.chatMessageGptMinWidth,children:e.jsx(ao,{})})]}),_e?e.jsxs(e.Fragment,{children:[e.jsx(ve,{message:H.current}),e.jsx("div",{className:f.chatMessageGptMinWidth,children:e.jsx(ro,{error:_e.toString(),onRetry:()=>oe(H.current)})})]}):null,e.jsx("div",{ref:Ie})]}):e.jsxs("div",{className:f.chatEmptyState,children:[e.jsx(Qs,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:f.chatEmptyStateTitle,children:"Chat with your data"}),e.jsx("h2",{className:f.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e.jsx(yo,{onExampleClicked:vs,useGPT4V:be})]}),e.jsx("div",{className:f.chatInput,children:e.jsx(po,{clearOnSend:!0,placeholder:"Type a new question (e.g. does my plan cover annual eye exams?)",disabled:Se,onSend:o=>oe(o),showSpeechInput:ns})})]}),I.length>0&&te&&e.jsx(Qo,{className:f.chatAnalysisPanel,activeCitation:ze,onActiveTabChanged:o=>ae(o,se),citationHeight:"810px",answer:I[se][1],activeTab:te}),e.jsxs(ln,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>s(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(qe,{onClick:()=>s(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(G,{id:st,className:f.chatSettingsSeparator,defaultValue:n,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:ds,"aria-labelledby":tt,onRenderLabel:o=>e.jsx(C,{labelId:tt,fieldId:st,helpText:T.promptTemplate,label:o?.label})}),e.jsx(G,{id:ot,className:f.chatSettingsSeparator,label:"Temperature",type:"number",min:0,max:1,step:.1,defaultValue:a.toString(),onChange:us,"aria-labelledby":nt,onRenderLabel:o=>e.jsx(C,{labelId:nt,fieldId:ot,helpText:T.temperature,label:o?.label})}),e.jsx(G,{id:rt,className:f.chatSettingsSeparator,label:"Seed",type:"text",defaultValue:h?.toString()||"",onChange:hs,"aria-labelledby":at,onRenderLabel:o=>e.jsx(C,{labelId:at,fieldId:rt,helpText:T.seed,label:o?.label})}),e.jsx(G,{id:lt,className:f.chatSettingsSeparator,label:"Minimum search score",type:"number",min:0,step:.01,defaultValue:S.toString(),onChange:ps,"aria-labelledby":it,onRenderLabel:o=>e.jsx(C,{labelId:it,fieldId:lt,helpText:T.searchScore,label:o?.label})}),Xe&&e.jsx(G,{id:dt,className:f.chatSettingsSeparator,label:"Minimum reranker score",type:"number",min:1,max:4,step:.1,defaultValue:u.toString(),onChange:ms,"aria-labelledby":ct,onRenderLabel:o=>e.jsx(C,{labelId:ct,fieldId:dt,helpText:T.rerankerScore,label:o?.label})}),e.jsx(G,{id:ht,className:f.chatSettingsSeparator,label:"Retrieve this many search results:",type:"number",min:1,max:50,defaultValue:_.toString(),onChange:gs,"aria-labelledby":ut,onRenderLabel:o=>e.jsx(C,{labelId:ut,fieldId:ht,helpText:T.retrieveNumber,label:o?.label})}),e.jsx(G,{id:mt,className:f.chatSettingsSeparator,label:"Exclude category",defaultValue:k,onChange:Ss,"aria-labelledby":pt,onRenderLabel:o=>e.jsx(C,{labelId:pt,fieldId:mt,helpText:T.excludeCategory,label:o?.label})}),Xe&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:xt,className:f.chatSettingsSeparator,checked:j,label:"Use semantic ranker for retrieval",onChange:xs,"aria-labelledby":gt,onRenderLabel:o=>e.jsx(C,{labelId:gt,fieldId:xt,helpText:T.useSemanticReranker,label:o?.label})}),e.jsx(Q,{id:bt,className:f.chatSettingsSeparator,checked:xe,label:"Use semantic captions",onChange:fs,disabled:!j,"aria-labelledby":ft,onRenderLabel:o=>e.jsx(C,{labelId:ft,fieldId:bt,helpText:T.useSemanticCaptions,label:o?.label})})]}),e.jsx(Q,{id:yt,className:f.chatSettingsSeparator,checked:O,label:"Suggest follow-up questions",onChange:ys,"aria-labelledby":St,onRenderLabel:o=>e.jsx(C,{labelId:St,fieldId:yt,helpText:T.suggestFollowupQuestions,label:o?.label})}),Je&&e.jsx(ua,{gpt4vInputs:De,isUseGPT4V:be,updateUseGPT4V:o=>{Wt(o)},updateGPT4VInputs:o=>Kt(o)}),Zt&&e.jsx(ia,{defaultRetrievalMode:g,showImageOptions:be&&Je,updateVectorFields:o=>Ht(o),updateRetrievalMode:o=>x(o)}),D&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:wt,className:f.chatSettingsSeparator,checked:Ge||de,label:"Use oid security filter",disabled:!Re||de,onChange:_s,"aria-labelledby":_t,onRenderLabel:o=>e.jsx(C,{labelId:_t,fieldId:wt,helpText:T.useOidSecurityFilter,label:o?.label})}),e.jsx(Q,{id:jt,className:f.chatSettingsSeparator,checked:$e||de,label:"Use groups security filter",disabled:!Re||de,onChange:ws,"aria-labelledby":vt,onRenderLabel:o=>e.jsx(C,{labelId:vt,fieldId:jt,helpText:T.useGroupsSecurityFilter,label:o?.label})})]}),e.jsx(Q,{id:Tt,className:f.chatSettingsSeparator,checked:U,label:"Stream chat completion responses",onChange:bs,"aria-labelledby":Ct,onRenderLabel:o=>e.jsx(C,{labelId:Ct,fieldId:Tt,helpText:T.streamChat,label:o?.label})}),D&&e.jsx(la,{})]})]})]})},pa="_layout_1qey7_1",ma="_header_1qey7_7",ga="_headerContainer_1qey7_12",xa="_headerTitleContainer_1qey7_21",fa="_headerLogo_1qey7_28",ba="_headerTitle_1qey7_21",Sa="_headerNavList_1qey7_38",ya="_show_1qey7_52",_a="_headerNavPageLink_1qey7_56",wa="_headerNavPageLinkActive_1qey7_73",va="_headerNavLeftMargin_1qey7_81",ja="_microsoftLogo_1qey7_85",Ca="_githubLogo_1qey7_86",Ta="_menuToggle_1qey7_90",Ia="_loginMenuContainer_1qey7_100",ka="_headerRightText_1qey7_140",P={layout:pa,header:ma,headerContainer:ga,headerTitleContainer:xa,headerLogo:fa,headerTitle:ba,headerNavList:Sa,show:ya,headerNavPageLink:_a,headerNavPageLinkActive:wa,headerNavLeftMargin:va,microsoftLogo:ja,githubLogo:Ca,menuToggle:Ta,loginMenuContainer:Ia,headerRightText:ka},La="_loginButton_9wb7v_1",Na={loginButton:La},Aa=()=>{const{instance:t}=me(),{loggedIn:s,setLoggedIn:n}=i.useContext(pe),r=t.getActiveAccount(),[a,l]=i.useState("");i.useEffect(()=>{(async()=>{l(await Ee(t)??"")})()},[]);const h=()=>{t.loginPopup({...Nn,redirectUri:qt()}).catch(u=>console.log(u)).then(async()=>{n(await Be(t)),l(await Ee(t)??"")})},c=()=>{r?t.logoutPopup({mainWindowRedirectUri:"/",account:t.getActiveAccount()}).catch(u=>console.log(u)).then(async()=>{n(await Be(t)),l(await Ee(t)??"")}):Rn()};return e.jsx(qe,{text:s?`Logout
${a}`:"Login",className:Na.loginButton,onClick:s?c:h})},Mt=()=>{const[t,s]=i.useState(!1),n=i.useRef(null),r=()=>{s(!t)},a=l=>{n.current&&!n.current.contains(l.target)&&s(!1)};return i.useEffect(()=>(t?document.addEventListener("mousedown",a):document.removeEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}),[t]),e.jsxs("div",{className:P.layout,children:[e.jsx("header",{className:P.header,role:"banner",children:e.jsxs("div",{className:P.headerContainer,ref:n,children:[e.jsx(Fs,{to:"/",className:P.headerTitleContainer,children:e.jsx("h3",{className:P.headerTitle,children:"Azure OpenAI + AI Search"})}),e.jsx("nav",{children:e.jsxs("ul",{className:`${P.headerNavList} ${t?P.show:""}`,children:[e.jsx("li",{children:e.jsx(It,{to:"/",className:({isActive:l})=>l?P.headerNavPageLinkActive:P.headerNavPageLink,onClick:()=>s(!1),children:"Chat"})}),e.jsx("li",{children:e.jsx(It,{to:"/qa",className:({isActive:l})=>l?P.headerNavPageLinkActive:P.headerNavPageLink,onClick:()=>s(!1),children:"Ask a question"})})]})}),e.jsxs("div",{className:P.loginMenuContainer,children:[D&&e.jsx(Aa,{}),e.jsx(W,{iconProps:{iconName:"GlobalNavButton"},className:P.menuToggle,onClick:r,ariaLabel:"Toggle menu"})]})]})}),e.jsx(Rs,{})]})},Fa=()=>{const[t,s]=i.useState(!1);if(D){var n=new Ps(Ln);return!n.getActiveAccount()&&n.getAllAccounts().length>0&&n.setActiveAccount(n.getActiveAccount()),n.addEventCallback(r=>{if(r.eventType===Es.LOGIN_SUCCESS&&r.payload){const a=r.payload;n.setActiveAccount(a)}}),i.useEffect(()=>{(async()=>{s(await Be(n))})()},[]),e.jsx(Ms,{instance:n,children:e.jsx(pe.Provider,{value:{loggedIn:t,setLoggedIn:s},children:e.jsx(Mt,{})})})}else return e.jsx(pe.Provider,{value:{loggedIn:t,setLoggedIn:s},children:e.jsx(Mt,{})})};Us();const Ra=Os([{path:"/",element:e.jsx(Fa,{}),children:[{index:!0,element:e.jsx(ha,{})},{path:"qa",lazy:()=>kt(()=>import("./Ask-f696b983.js"),["assets/Ask-f696b983.js","assets/vendor-9f0443cf.js","assets/fluentui-react-7118eba4.js","assets/fluentui-icons-153f2197.js","assets/Ask-3d7c765c.css"])},{path:"*",lazy:()=>kt(()=>import("./NoPage-e1d29130.js"),["assets/NoPage-e1d29130.js","assets/vendor-9f0443cf.js"])}]}]);Bs.createRoot(document.getElementById("root")).render(e.jsx(Vs.StrictMode,{children:e.jsx(qs,{router:Ra})}));export{Rt as A,yo as E,$ as G,C as H,pe as L,po as Q,N as R,Jo as S,la as T,oa as U,M as V,B as a,ro as b,Qo as c,ua as d,ia as e,En as f,Un as g,ue as h,Oa as i,de as r,T as t,D as u};
//# sourceMappingURL=index-969d0285.js.map
